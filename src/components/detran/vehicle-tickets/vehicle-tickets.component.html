<ion-view title="Multas por Veículo">
	<ion-content id="state-driver-license-status" class="md-espm-content">
		<md-content>
			<!-- Card with status -->
			<md-card class="card-driver-license" ng-class="{ 'bg-green-70': vm.licenseOk, 'bg-red-70': vm.licenseBlocked, 'bg-pink-70': vm.licenseExpired, 'bg-yellow-70': vm.licenseRenew }">
				<md-card-header ng-hide="!vm.driverDataPopulated || vm.licenseBlocked || vm.licenseRenew || vm.licenseExpired">
					<md-card-avatar>
						<i class="fa fa-car" aria-hidden="true"></i>
					</md-card-avatar>
					<md-card-header-text>
						<span class="md-title">CNH Ok - Dirija com segurança</span>
						<span class="md-subhead">CNH válida até {{vm.expirationDate | calendar}}</span>
					</md-card-header-text>
				</md-card-header>
				<md-card-header ng-show="vm.driverDataPopulated && vm.licenseRenew && !vm.licenseBlocked">
					<md-card-avatar>
						<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
					</md-card-avatar>
					<md-card-header-text>
						<span class="md-title">Está na hora de renovar</span>
						<span class="md-subhead">Expira {{vm.expirationDate | fromNow: true}}</span>
					</md-card-header-text>
				</md-card-header>
				<md-card-header ng-show="vm.driverDataPopulated && vm.licenseExpired && !vm.licenseBlocked">
					<md-card-avatar>
						<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
					</md-card-avatar>
					<md-card-header-text>
						<span class="md-title">Renove sua CNH</span>
						<span class="md-subhead">Expirou à {{vm.expirationDate | fromNow: true}}</span>
					</md-card-header-text>
				</md-card-header>
				<md-card-header ng-show="vm.driverDataPopulated && vm.licenseBlocked">
					<md-card-avatar>
						<i class="fa fa-ban" aria-hidden="true"></i>
					</md-card-avatar>
					<md-card-header-text>
						<span class="md-title">CNH Bloqueada</span>
						<span class="md-subhead">{{::vm.driverData.blockMotive}}</span>
					</md-card-header-text>
				</md-card-header>
				<md-card-title-text ng-hide="vm.driverDataPopulated">
					<br />
					<ion-spinner icon="android"></ion-spinner>
				</md-card-title-text>
			</md-card>

			<h4 class="list-header tickets-history">Histórico de Multas</h4>
			<div class="center">
				<ion-spinner ng-hide="vm.ticketsPopulated" icon="android"></ion-spinner>
			</div>

			<div ng-show="vm.ticketsPopulated && !vm.hasTickets" class="center">
				<div class="md-padding">
					<div class="md-subhead">Nenhuma Multa</div>
				</div>
				<md-divider></md-divider>
			</div>

			<md-item ng-repeat="ticket in vm.tickets track by $index" 
					 class="ticket"
					 ng-class="{ 'selected-ticket': $index == vm.selectedIndex}">
				<md-item-content ng-class="{ 'selected md-whiteframe-10dp': $index == vm.selectedIndex}" layout="column">
					<div layout="row" ng-click="vm.showDetails($index)" class="folded">
						<div class="md-tile-left">
							<div class="avatar-points bg-{{::vm.getClassificationColor( ticket.classification ) }}">{{::ticket.points}}</div>
						</div>
						<div class="md-tile-content" layout="column" layout-align="center start">
							<h4>{{::ticket.classification | capitalize}} - {{::ticket.date | calendar}}</h4>
							<p>
								{{::ticket.place | capitalize}}, {{::ticket.district | capitalize}}
							</p>
						</div>
					</div>
					<md-divider ng-show="$index == vm.selectedIndex"></md-divider>
					<div layout="column" class="expanded">
						<p><strong>Placa:</strong> {{::ticket.plate}}</p>
						<p>{{::ticket.description}}</p>
					</div>
				</md-item-content>
				<md-divider class="divider-inset" ng-hide="$index == vm.selectedIndex && $last"></md-divider>
			</md-item>
		</md-content>
	</ion-content>
	<!--Dashboard section-->
</ion-view>